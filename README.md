# Prompt (старый)

Создайте проект на Godot 4.1 с механикой RTS-лайт в трёх линиях атаки.
- Главная сцена битвы на планете: после высадки с орбиты (для людей) разворачивается бой на трёх параллельных линиях.
- Спроектируйте спавнеры для разных рас: люди (высадка с орбиты), эльфы (порталы), нежить (появление из-под земли) и орки (спец-спавн по желанию).
- Юниты должны автоматически появляться через здания, двигаться вперёд по линии и атаковать при встрече с противником.
- Сфокусируйтесь на боевой логике и ИИ; интерфейс и прокачка — на следующих итерациях.
- Первый модуль: PvE-сцена с врагом на ИИ, действующим по тем же правилам, что и игрок.
- Используйте 3D-примитивы (кубы, сферы) вместо спрайтов для прототипирования графики.
- Сгенерируйте README со структурами: Общая идея, Механика, Структура кода, TODO, Архитектура, Prompt.
- Включите этот текст запроса в раздел README «Prompt».
- В README чётко опишите: сцены, основные действия, ввод/вывод, условие победы/результата и заложенные будущие фичи (герои, PvP, орбитальный город и др.).
- Добавьте задачи (TODO) и предложения по улучшению кода (рефакторинг, абстракции) в соответствующий раздел README.
- Сохраняйте рабочие итерации в git hub перед крупными изменениями.

---

# Prompt (новый)

* Создайте проект на Godot 4.1 с механикой RTS-lite с размещением спавнеров в любой точке своей половины карты.
* Основная цель: защита ядра и стратегическое наступление на вражеские постройки. Каждый игрок размещает здания на своей половине.
* Автоматические юниты: юниты призываются зданиями, перемещаются с учётом ландшафта, сражаются с вражескими юнитами и структурами.
* У всех рас (начиная с людей) будет сборщик ресурсов у ядра. Ресурсы питают ядро и позволяют призывать элитные отряды.
* Фокус разработки — PvE: AI противника действует по тем же правилам, что и игрок.
* Интерфейс, PvP и графика — на следующих этапах. Сейчас — только механика.
* Использовать 3D-примитивы (PlaneMesh, CubeMesh и т.п.) для теста.
* Добавьте карту с зонами постройки, ядром и полем боя.
* Сохраняйте сцены в закрытом виде (не открытыми в редакторе), чтобы избежать парсинг-ошибок Godot.
* Проблема с Godot: при открытой сцене в редакторе, изменения через Cursor могут привести к ошибкам парсера или крашу при запуске. Это важно указать в README.

---

## Общая идея

- Игра в жанре RTS-lite с автоматическим боем.
- Игрок размещает постройки на своей стороне поля.
- Каждая раса имеет уникальную механику спавна и сбора ресурсов.
- Энергия от ресурсов питает ядро и открывает доступ к элитным войскам.

## Механика

- Автоматическое движение и бой.
- Спавн через здание.
- Ландшафт влияет на путь юнитов.
- PvE-сражения против AI (на первом этапе).

## Архитектура

- **Scene:** Battle.tscn
- **Nodes:** Camera3D, ядра сторон, поля, UI, спавнеры.
- **Scripts:** UnitAI.gd, Spawner.gd, ResourceCollector.gd

## TODO

- [ ] Реализовать ядро и энергию.
- [ ] Построение спавнеров на карте.
- [ ] Движение юнитов к ближайшей цели.
- [ ] Сбор ресурсов и энергия.
- [ ] Минимальный UI с кнопкой старта и логом боя.

## Важно

- Храните все сцены закрытыми перед редактированием.
- Ошибка Godot: `gd_scene format=3 uid=...` крашится, если UID нарушен или сцена не была корректно сохранена.

## GitHub

- После каждой стабильной итерации делайте commit в GitHub.

# TERRION — RTS-lite стратегия на Godot 4.1 (свободное размещение спавнеров)

## Общая идея

TERRION — мобильная RTS-lite стратегия, вдохновлённая Clash Mini, Boom Beach и классическими RTS. Битва разворачивается на 3D-карте с ландшафтом и препятствиями. Игрок и AI размещают здания-спавнеры в любой точке своей половины карты. Каждый спавнер порождает уникальных юнитов. Юниты ищут и атакуют ближайших врагов, используя навигацию по карте. Победа достигается уничтожением всех спавнеров противника или базы.

## Механика

- **Свободное размещение зданий:** игрок и AI могут размещать спавнеры (базы, казармы и т.д.) в любой точке своей половины карты (drag&drop или клик по сетке).
- **Разные типы спавнеров:** каждый спавнер порождает свой тип мобов с уникальными характеристиками и способностями.
- **Ландшафт и препятствия:** карта содержит зоны с разной проходимостью, препятствия, влияющие на путь юнитов.
- **Навигация:** юниты используют NavigationRegion3D или A* для поиска пути к врагу, обходя препятствия.
- **AI:** враг размещает спавнеры и действует по тем же правилам, что и игрок, выбирая стратегию размещения и атаки.
- **Автоматический бой:** юниты самостоятельно ищут и атакуют ближайших врагов (юнитов или здания).
- **Ресурсы:** накапливаются со временем или за действия на поле, тратятся на размещение зданий и спавн юнитов.
- **Победа:** уничтожение всех спавнеров противника или базы.

## Структура кода

- **Battle.tscn:** корневая сцена боя (Node3D), содержит карту, ландшафт, NavigationRegion3D, размещённые здания.
- **Spawner.tscn:** здание-спавнер (Node3D + MeshInstance3D + Timer), можно размещать в любом месте. Разные типы для разных рас/юнитов.
- **Unit.tscn:** базовый юнит (CharacterBody3D/KinematicBody3D + CollisionShape3D + MeshInstance3D). Логика поиска цели, движения, атаки, смерти.
- **BattleManager.gd:** главный скрипт сцены, управляет циклом боя, ресурсами, условиями победы, размещением зданий.
- **AIEnemy.gd:** скрипт AI врага, реализует стратегию размещения зданий и атаки.
- **BattleUI.tscn/gd:** интерфейс: ресурсы, кнопки размещения, миникарта, экран победы/поражения.
- **NavigationRegion3D:** добавляется на карту для поддержки поиска пути.

## TODO / Roadmap

- [ ] Убрать фиксированные линии, реализовать свободное размещение спавнеров.
- [ ] Добавить карту с ландшафтом и препятствиями.
- [ ] Реализовать систему навигации (NavigationRegion3D, A*).
- [ ] Сделать разные типы спавнеров и мобов.
- [ ] Реализовать drag&drop или клик для размещения зданий.
- [ ] Юниты ищут и атакуют ближайших врагов (юнитов или здания).
- [ ] AI размещает спавнеры и действует по тем же правилам.
- [ ] UI для размещения, выбора типа спавнера, миникарта.
- [ ] Улучшить визуал: различия между расами, эффекты, анимации.
- [ ] Начать проектирование PvP: базовая сетевая синхронизация.
- [ ] Ввести систему апгрейдов и героев.
- [ ] Добавить мета-игру (Орбитальный город).
- [ ] Вести журнал событий и добавить тесты.

## Архитектура

- **Сцены:** Battle (корень), карта с ландшафтом, NavigationRegion3D, размещаемые спавнеры, юниты.
- **Действия:**
  - Размещение зданий на своей половине
  - Спавн юнитов зданиями
  - Движение юнитов по навигации
  - Автоматический бой при встрече
  - Урон по зданиям/юнитам
  - Победа при уничтожении всех спавнеров противника
  - Ввод: размещение зданий, выбор типа
  - Вывод: состояние боя, ресурсы, победитель
- **Результат:** Битва завершается при уничтожении всех спавнеров противника или по таймеру. Генерируется событие победы.
- **Будущее:**
  - Герои (Hero.gd, HeroScene)
  - PvP (NetworkManager, синхронизация)
  - Орбитальный город (OrbitalCity.tscn)

# Новое в текущей версии (июнь 2024)

- Полностью переработан UI под мобильные устройства:
  - Кнопки призыва и строительства внизу, равномерно и адаптивно размещены.
  - Информация о HP и ресурсах игрока/врага — по краям сверху.
  - Кнопки "Старт" и "Выход" — компактно справа вверху.
  - Все элементы UI не накладываются друг на друга, адаптированы под touch.
- Поле боя теперь вертикальное:
  - Игрок размещается снизу (Z < 0), враг — сверху (Z > 0).
  - Камера строго сверху (rotation_degrees.x = -90), поле вытянуто по вертикали.
  - Все спавны и движения юнитов учитывают новую ориентацию.
- Динамическое масштабирование:
  - При большом количестве построек (>10) карта автоматически увеличивается, камера отдаляется.
  - Масштабирование плавное, не мешает управлению.
- Интеграция:
  - Кнопки работают: призыв юнитов за ресурсы, строительство зданий (заготовка).
  - UI обновляется в реальном времени.
  - Логика спавна и движения адаптирована под вертикальную ориентацию.

## TODO (актуализировано)
- [x] Мобильный UI, адаптивные панели, отсутствие наложений
- [x] Вертикальная ориентация поля, камера сверху
- [x] Динамическое масштабирование карты и камеры
- [ ] Реализовать строительство зданий (логика)
- [ ] Добавить drag&drop или клик для размещения зданий
- [ ] Улучшить визуал: эффекты, анимации, разделение зон
- [ ] AI размещает спавнеры и действует по тем же правилам
- [ ] PvP и мета-игра (на будущее)

## Архитектура (дополнено)
- **UI:** адаптивный CanvasLayer с контейнерами для мобильных устройств
- **Поле:** вертикальное, масштабируемое, камера строго сверху
- **Механика:** все действия и спавны учитывают новую ориентацию

---



    

  
